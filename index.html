<!DOCTYPE html>
<html lang="it">

<head>
    <script id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="22fcdb45-4809-417b-9a01-c9683960b17b"
        type="text/javascript" async></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HCL5TVJMD5"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-HCL5TVJMD5');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car's world</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a73e8">

    <style>
        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background-color: #f0f2f5;
            margin: 0;
            padding-top: 80px;
            color: #333;
        }

        .container {
            max-width: 650px;
            margin: auto;
            padding: 15px;
        }

        header {
            position: fixed;
            top: 0; left: 0; right: 0;
            height: 60px;
            background: #1a73e8;
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 15px;
            z-index: 10000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        header h1 {
            font-size: 23px;
            margin: 0;
            text-transform: uppercase;
            flex-grow: 1;
            text-align: center;
        }

        .nav-fissa {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 7px 7px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            font-size: 14px;
            text-transform: uppercase;
        }

        .nav-fissa:disabled { opacity: 0.3; }

        #barra-ricerca {
            width: 100%;
            padding: 10px;
            font-size: 18px;
            border-radius: 12px;
            border: 2px solid #1a73e8;
            margin-bottom: 20px;
            box-sizing: border-box;
            outline: none;
            background-color: #ffffff !important;
        }

        .nascosto { display: none !important; }

        button.main-btn {
            width: 70%;
            display: block;
            padding: 30px;
            margin: 10px auto;
            font-size: 17px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 12px;
            background: white;
            color: #1a73e8;
            border: 2px solid #e0e0e0;
            text-transform: uppercase;
        }

        /* OVERLAY PUBBLICITÃ€ INTERSTITIAL */
        #overlay-pubblicita {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 99999;
            text-align: center;
        }

        .timer-cerchio {
            font-size: 50px;
            border: 5px solid #1a73e8;
            border-radius: 50%;
            width: 100px; height: 100px;
            display: flex; align-items: center; justify-content: center;
            margin: 20px 0;
            font-weight: bold;
        }

        /* BANNER FISSO PRIMA DEI CONTATTI */
        .banner-fisso-container {
            width: 100%;
            min-height: 100px;
            background: #ffffff;
            margin: 40px 0 10px 0; /* Spazio sopra e sotto */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            border: 1px dashed #bbb;
        }

        .btn-categoria { background: #1a73e8 !important; color: white !important; border: none; }
        .btn-ibride { background: #28a745 !important; color: white !important; border: none; }
        .btn-tagliandi { background: #ff9800 !important; color: white !important; border: none; }

        .scheda-finale {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            text-align: left;
        }

        .etichetta {
            font-weight: bold;
            color: #1a73e8;
            text-transform: uppercase;
            font-size: 12px;
            display: block;
            margin-top: 15px;
        }

        .info-testo, .box-ibrido {
            font-size: 17px;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #eee;
            margin-bottom: 10px;
        }

        .box-ibrido { background: #e8f5e9; border-left: 4px solid #28a745; }

        .scheda-risultato {
            background: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            cursor: pointer;
            border-left: 5px solid #1a73e8;
        }

        #sezione-contatti {
            padding: 20px;
            background: #fff;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        @media print {
            header, #barra-ricerca, .btn-stampa, #sezione-contatti, .banner-fisso-container, #overlay-pubblicita {
                display: none !important;
            }
        }
    </style>
</head>

<body>

    <div id="overlay-pubblicita" class="nascosto">
        <h2 style="padding:0 20px;">Caricamento in corso...</h2>
        <div id="timer-secondi" class="timer-cerchio">3</div>
        <p>Stiamo preparando i dati tecnici</p>
    </div>

    <header>
        <button class="nav-fissa" id="btn-indietro-fisso" onclick="vaIndietroUniversale()" disabled>Indietro</button>
        <h1>Car's world</h1>
        <button class="nav-fissa" onclick="vaiAllaHome()">Home</button>
    </header>

    <div class="container">
        <input type="text" id="barra-ricerca" placeholder="ðŸ” Cerca marca o modello..." onkeyup="ricercaVeloce()">

        <div id="risultati-ricerca" class="nascosto"></div>

        <div id="livello-categoria">
            <button class="main-btn btn-categoria" onclick="vaiAMarche('auto')">AUTO (TELAIO / OBD)</button>
            <button class="main-btn btn-categoria" onclick="vaiAMarche('moto')">MOTO / CICLOMOTORI</button>
            <button class="main-btn btn-ibride" onclick="vaiAMarche('ibride')">AUTO IBRIDE (MANUTENZIONE)</button>
            <button class="main-btn btn-tagliandi" style="opacity: 0.5; cursor: not-allowed;" onclick="return false;" disabled>PIANI TAGLIANDO (In lavorazione)</button>
        </div>

        <div id="livello-marche" class="nascosto"><div id="lista-marche"></div></div>
        <div id="livello-modelli" class="nascosto"><div id="lista-modelli"></div></div>
        
        <div id="livello-scheda" class="nascosto">
            <div id="dati-veicolo" class="scheda-finale"></div>
            <button class="main-btn" style="background: #e91e63; color: white; border: none; margin-top: 15px; padding: 15px;" onclick="window.print()">STAMPA SCHEDA</button>
        </div>

        <div class="banner-fisso-container">
            <p style="color:#bbb; font-size:10px; margin-bottom:5px;">ANNUNCIO PUBBLICITARIO</p>
            <div style="width:320px; height:50px; background:#f9f9f9; border:1px solid #eee; display:flex; align-items:center; justify-content:center; color:#ccc;">
                Banner Pubblicitario
            </div>
        </div>

        <div id="sezione-contatti">
            <h3 style="color: #1a73e8; margin-top:0;">Contattami</h3>
            <form action="https://formspree.io/f/tuocodice" method="POST" style="text-align: left;">
                <input type="text" name="nome" placeholder="Il tuo nome" required style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid #ccc; box-sizing: border-box;">
                <input type="email" name="_replyto" placeholder="La tua email" required style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid #ccc; box-sizing: border-box;">
                <textarea name="messaggio" placeholder="Cosa altro vorresti trovare..." required style="width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ccc; height:100px; box-sizing: border-box; font-family: sans-serif;"></textarea>
                <button type="submit" style="background:#333; color:white; padding:12px; width:100%; border-radius:8px; border:none; cursor:pointer; font-weight:bold;">INVIA MESSAGGIO</button>
            </form>
        </div>
    </div>

    <script>
        const database = {
            auto: {
                "Fiat": {
                    "Panda": [
                        { versione: "3 serie (2012-oggi)", telaio: "Aprire il bagagliaio, alzare il tappetino, si trova sulla destra fuori dal vano ruota di scorta", eobd: "A sinistra dello sterzo c'Ã¨ uno sportellino ad incastro va tirato dalla parte bassa, la presa la trovi subito li" },
                        { versione: "2 serie (2003-2013)", telaio: "Aprire il bagagliaio, alzare il tappetino, si trova sulla destra fuori dal vano ruota di scorta", eobd: "A sinistra dello sterzo c'Ã¨ uno sportellino, vanno svitate le viti a croce la presa la trovi subito li davanti" },
                        { versione: "1 serie (1980-2003)", telaio: "Aprire il cofano motore, si trova sopra all'ammortizzatore lato passeggero", eobd: "Non presente in questo veicolo" }
                    ],
                    "Punto": [
                        { versione: "3 serie (2007-2010)", telaio: "Pianale lato passeggero, alzare il tappetino, c'Ã¨ uno sportellino da aprire", eobd: "Sulla sinistra dello sterzo c'Ã¨ una plastica con dei pulsanti, sotto un cassettino che va aperto, infilata la mano e tirata tutta la plastica dall'alto. resta agganciata nella parte in basso! la presa la trovi li davanti sotto una protezione" },
                        { versione: "2 serie (2003-2007)", telaio: "Pianale lato passeggero, alzare il tappetino c'Ã¨ uno sportellino da alzare", eobd: "Sulla sinistra dello sterzo c'Ã¨ una plastica con due viti a taglio svitare le due viti e la si trova subito li sotto" }
                    ],
                    "500":[
                        {versione: "Motore a scoppio", telaio: "Aprire il bagagliaio, alzare il tappetino, si trova sulla destra fuori dal vano ruota di scorta", eobd:"sulla sinistra dello sterzo, c'Ã¨ uno sportellino di plastica, va tirato dal basso, la presa si trova li davanti, in alcune ce una copertura di plastica"}
                    ]
                },
                "Opel": { "Astra": [ { versione: "Astra J (2009-2015)", telaio: "Pianale lato passeggero, alzare il tappetino c'Ã¨ uno sportellino vicino al battitacco", eobd: "Sotto lo sterzo, a fine della plastica sulla sinistra" } ] },
                "Mercedes": { "Classe C": [ { versione: "Serie W203 (2000-2007)", telaio: "Sotto il seggiolino lato passeggero, va tirato indietro c'Ã¨ un ritaglio nella moquette", eobd: "Sotto cruscotto lato guida,c'Ã¨ uno sportellino nero" } ] },
                "Audi": { "A4": [ { versione: "Serie B8 (2012-2016)", telaio: "Sgocciolatoio destro (lato passeggero) sotto una protezione con scritto VIN", eobd: "Sotto cruscotto sx lo si nota bene per il suo colore fucsia" } ] },
                "Porsche": { "Cayman/Boxster": [ { versione: "981 (2015)", telaio: "Sotto il seggiolino lato passeggero, va tirato tutto indietro, trovi un ritaglio nella moquette e sotto vedrai il telaio", eobd: "Ai piedi del guidatore sulla sinistra c'Ã¨ una plastica con un'apertura nella parte alta, va aperta tirando da li una volta infilata la mano, la presa la trovi in basso sotto i fusibili" } ] },
                "Jeep": { "Grand Cherokee": [ { versione: "3 Gen WK-WH (2004-2010)", telaio: "Alzare la plastica nel battitacco sportello anteriore destro, una volta levato consiglio di sporgesrsi un pochino dentro la macchina perchÃ© rimane sotto la guarnizione e potrebbe sembrare che non ci sia", eobd: "Sotto il cruscotto lato guida" } ] },
                "Toyota": { "Yaris": [ { versione: "Hybrid (2020-oggi)", telaio: "Sotto sedile passeggero", eobd: "Sotto il cruscotto sotto il volante, la si nota bene per il suo colore bianco" } ] },
                "Volkswagen": { "Polo": [ {versione: "V serie (2009-2017)", telaio:"Aprire il cofano motore, guardare nello sgocciolatoio destro (lato passeggero) all'altezza dell'ammortizzatore", eobd: "Sotto il volante sulla sinistra vicino al montante! lo si nota bene dal suo colore fucsia" } ] }
            },
            moto: { "Ducati": { "Monster": [{ versione: "Tutte le serie", telaio: "Cannotto sterzo", eobd: "Sotto sella" }] } },
            ibride: { "Toyota": { "Yaris": [ { versione: "Hybrid (2020-oggi)", procedura: "Macchina spenta, cambio in P, quadro acceso. 2 acceleratore in P, 2 acceleratore in N, 2 acceleratore in P. Appare 'Maintenance mode'." } ] } },
            tagliandi: { "Fiat": { "Panda": [{ versione: "1.2 Fire", motore: "188A4000", tagliando: "20.000km/1anno", olio: "2.8L 5W40 ACEA C3", filtri: "Olio: L316" }] } }
        };

        let categoriaCorrente = "", marcaCorrente = "", modelloCorrente = "", livelloAttuale = "categoria", ultimoLivelloPrimaDellaRicerca = "categoria";

        function nascondiTutti() {
            ['livello-categoria', 'livello-marche', 'livello-modelli', 'livello-scheda', 'risultati-ricerca', 'sezione-contatti'].forEach(id => {
                document.getElementById(id).classList.add('nascosto');
            });
        }

        function vaiAllaHome() {
            livelloAttuale = "categoria"; ultimoLivelloPrimaDellaRicerca = "categoria";
            document.getElementById('barra-ricerca').value = "";
            document.getElementById('btn-indietro-fisso').disabled = true;
            nascondiTutti();
            document.getElementById('livello-categoria').classList.remove('nascosto');
            document.getElementById('sezione-contatti').classList.remove('nascosto');
            window.scrollTo(0, 0);
        }

        function vaiAMarche(cat) {
            categoriaCorrente = cat; livelloAttuale = "marche"; ultimoLivelloPrimaDellaRicerca = "marche";
            document.getElementById('btn-indietro-fisso').disabled = false;
            nascondiTutti();
            document.getElementById('livello-marche').classList.remove('nascosto');
            let container = document.getElementById('lista-marche');
            container.innerHTML = "";
            Object.keys(database[cat]).forEach(marca => {
                container.innerHTML += `<button class="main-btn" onclick="vaiAModelli('${marca}')">${marca}</button>`;
            });
        }

        function vaiAModelli(marca) {
            marcaCorrente = marca; livelloAttuale = "modelli"; ultimoLivelloPrimaDellaRicerca = "modelli";
            nascondiTutti();
            document.getElementById('livello-modelli').classList.remove('nascosto');
            let container = document.getElementById('lista-modelli');
            container.innerHTML = `<h3>Scegli modello ${marca}</h3>`;
            Object.keys(database[categoriaCorrente][marca]).forEach(modello => {
                container.innerHTML += `<button class="main-btn" onclick="vaiAVersioni('${modello}')">${modello}</button>`;
            });
        }

        function vaiAVersioni(modello) {
            modelloCorrente = modello; livelloAttuale = "versioni";
            nascondiTutti();
            document.getElementById('livello-modelli').classList.remove('nascosto');
            let container = document.getElementById('lista-modelli');
            container.innerHTML = `<h3>Versione per ${modello}</h3>`;
            database[categoriaCorrente][marcaCorrente][modello].forEach((item, index) => {
                container.innerHTML += `<button class="main-btn" onclick="mostraScheda(${index})">${item.versione}</button>`;
            });
        }

        // LOGICA PUBBLICITÃ€ A COMPARSA (3 SECONDI)
        function mostraScheda(index, catRicerca, marcaRicerca, modRicerca) {
            const overlay = document.getElementById('overlay-pubblicita');
            const timerEl = document.getElementById('timer-secondi');
            overlay.classList.remove('nascosto');
            
            let count = 3;
            timerEl.innerText = count;

            const countdown = setInterval(() => {
                count--;
                timerEl.innerText = count;
                if (count <= 0) {
                    clearInterval(countdown);
                    overlay.classList.add('nascosto');
                    eseguiCaricamentoDati(index, catRicerca, marcaRicerca, modRicerca);
                }
            }, 1000);
        }

        function eseguiCaricamentoDati(index, catRicerca, marcaRicerca, modRicerca) {
            if (catRicerca) categoriaCorrente = catRicerca;
            if (marcaRicerca) marcaCorrente = marcaRicerca;
            if (modRicerca) modelloCorrente = modRicerca;
            
            livelloAttuale = "scheda";
            document.getElementById('btn-indietro-fisso').disabled = false;
            nascondiTutti();
            document.getElementById('livello-scheda').classList.remove('nascosto');
            
            let veicolo = database[categoriaCorrente][marcaCorrente][modelloCorrente][index];
            let htmlDati = `<h2>${marcaCorrente} ${modelloCorrente}</h2><p style="color:#1a73e8; font-weight:bold;">${veicolo.versione}</p>`;
            
            if (categoriaCorrente === 'tagliandi') {
                htmlDati += `
                    <span class="etichetta">Codice Motore:</span><div class="info-testo">${veicolo.motore}</div> 
                    <span class="etichetta">Intervallo:</span><div class="info-testo">${veicolo.tagliando}</div>
                    <div class="box-ibrido" style="background:#fff3e0; border-left-color:#ff9800">
                        <span class="etichetta" style="color:#e65100">Olio consigliato:</span><div style="padding:10px; font-weight:bold;">${veicolo.olio}</div>
                    </div>
                    <span class="etichetta">Filtri:</span><div class="info-testo">${veicolo.filtri}</div>
                `;
            } else {
                if (veicolo.telaio) htmlDati += `<span class="etichetta">Telaio:</span><div class="info-testo">${veicolo.telaio}</div>`;
                if (veicolo.eobd) htmlDati += `<span class="etichetta">EOBD:</span><div class="info-testo">${veicolo.eobd}</div>`;
                if (veicolo.procedura) htmlDati += `<div class="box-ibrido"><span class="etichetta">Manutenzione:</span>${veicolo.procedura}</div>`;
            }
            document.getElementById('dati-veicolo').innerHTML = htmlDati;
            window.scrollTo(0, 0);
        }

        function vaIndietroUniversale() {
            if (livelloAttuale === "ricerca") tornaAlLivelloPrecedente();
            else if (livelloAttuale === "marche") vaiAllaHome();
            else if (livelloAttuale === "modelli") vaiAMarche(categoriaCorrente);
            else if (livelloAttuale === "versioni") vaiAModelli(marcaCorrente);
            else if (livelloAttuale === "scheda") {
                if (document.getElementById('barra-ricerca').value.length > 0) ricercaVeloce();
                else vaiAVersioni(modelloCorrente);
            }
        }

        function tornaAlLivelloPrecedente() {
            document.getElementById('barra-ricerca').value = "";
            nascondiTutti();
            if (ultimoLivelloPrimaDellaRicerca === "marche") vaiAMarche(categoriaCorrente);
            else if (ultimoLivelloPrimaDellaRicerca === "modelli") vaiAModelli(marcaCorrente);
            else vaiAllaHome();
        }

        function ricercaVeloce() {
            let input = document.getElementById('barra-ricerca').value.toLowerCase();
            if (input.length === 0) { tornaAlLivelloPrecedente(); return; }
            nascondiTutti();
            livelloAttuale = "ricerca";
            document.getElementById('btn-indietro-fisso').disabled = false;
            const div = document.getElementById('risultati-ricerca');
            div.classList.remove('nascosto');
            div.innerHTML = "";
            let trovati = 0;
            for (let cat in database) {
                for (let marca in database[cat]) {
                    for (let modello in database[cat][marca]) {
                        database[cat][marca][modello].forEach((v, i) => {
                            if ((marca + " " + modello + " " + v.versione).toLowerCase().includes(input)) {
                                trovati++;
                                let d = document.createElement('div');
                                d.className = 'scheda-risultato';
                                d.innerHTML = `<strong>${marca} ${modello}</strong><br><small>${v.versione} (${cat.toUpperCase()})</small>`;
                                d.onclick = () => mostraScheda(i, cat, marca, modello);
                                div.appendChild(d);
                            }
                        });
                    }
                }
            }
            if (trovati === 0) div.innerHTML = "<p style='padding:20px; text-align:center;'>Nessun veicolo trovato.</p>";
        }

        // REGISTRAZIONE PWA
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js');
        }

        document.addEventListener('keydown', function (event) {
            if (event.keyCode === 46 || event.key === 'ArrowLeft') {
                if (document.activeElement.id !== 'barra-ricerca') {
                    vaIndietroUniversale();
                }
            }
        });
    </script>
</body>
</html>
